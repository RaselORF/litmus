---
# mayaonline can parse this yaml to obtain tests specific to applications (based on tag) & populate test params,
# fulfill pre-requisites etc, before deployment. The params are explicitly typed to prompt right values from user.
# Test parameters can be of different kinds such as ENV, configmap etc., with their own properties.
# The test has tags which will help with categorization & application-mapping.


tests:
  - name: openebs-volume-replica-failure
    test_tags: ['mysql', 'openebs']
    specPath: ./apps/percona/chaos/openebs_volume_replica_failure/run_litmus_test.yaml
    patch:
    - name: 'APPLICATION NAMESPACE'
      desc: ''
      kind: env
      type: string
      op: 'replace'
      path: '/spec/template/spec/containers/0/env/-'
      value:
        name: APP_NAMESPACE
        value: percona
    - name: 'APPLICATION LABEL'
      desc: ''
      kind: env
      type: string
      op: 'replace'
      path: '/spec/template/spec/containers/0/env/-'
      value:
        name: APP_LABEL
        value: name=percona # Label is a key-value pair 
    - name: 'APPLICATION VOLUME CLAIM'
      desc: ''
      kind: env
      type: string
      op: 'replace'
      path: '/spec/template/spec/containers/0/env/-'
      value:
        name: APP_PVC
        value: percona-mysql-claim
 
  - name: openebs-target-network-delay
    test_tags: ['mysql', 'openebs']
    specPath: ./apps/percona/chaos/openebs_target_network_delay/run_litmus_test.yaml
    patch:
    - name: 'APPLICATION NAMESPACE'
      desc: ''
      kind: env
      type: string
      op: 'replace'
      path: '/spec/template/spec/containers/0/env/-'
      value:
        name: APP_NAMESPACE
        value: percona
    - name: 'APPLICATION LABEL'
      desc: ''
      kind: env
      type: string
      op: 'replace'
      path: '/spec/template/spec/containers/0/env/-'
      value:
        name: APP_LABEL
        value: name=percona
    - name: 'APPLICATION PERSISTENT VOLUME CLAIM'
      desc: ''
      kind: env
      type: string
      op: 'replace'
      path: '/spec/template/spec/containers/0/env/-'
      value:
        name: APP_PVC
        value: percona-mysql-claim
    - name: 'DURATION OF NETWORK CHAOS'
      desc: ''
      kind: env
      type: string
      op: 'replace'
      path: '/spec/template/spec/containers/0/env/-'
      value:
        name: CHAOS_DURATION
        value: '60'
          # In pod spec this still needs to be quoted/taken as string (https://github.com/kubernetes/kubernetes/issues/2763)
